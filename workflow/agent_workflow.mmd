flowchart TD
    A[User Input] --> B{Is it an incident description?}
    
    B -->|No| C[Return help message]
    B -->|Yes| D[Call LLM for parsing]
    
    D --> E{LLM available and returns valid JSON?}
    
    E -->|Yes| F[Return structured JSON from LLM]
    E -->|No| G[Use fallback regex tools]
    
    G --> H[Extract date, location, type, impact]
    H --> I[Return structured JSON from regex]
    
    F --> J[Final Output: Structured Incident JSON]
    I --> J
    C --> K[Help/Error Response]
    
    style A fill:#1976d2,color:#ffffff
    style D fill:#f57c00,color:#ffffff
    style G fill:#388e3c,color:#ffffff
    style J fill:#00796b,color:#ffffff
    style K fill:#d32f2f,color:#ffffff